(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/todo/todo"],{"009e":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o("2f62");function i(t,e){return u(t)||a(t,e)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a(t,e){var o=[],n=!0,i=!1,r=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)if(o.push(a.value),e&&o.length===e)break}catch(c){i=!0,r=c}finally{try{n||null==u["return"]||u["return"]()}finally{if(i)throw r}}return o}function u(t){if(Array.isArray(t))return t}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},n=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),n.forEach(function(e){s(t,e,o[e])})}return t}function s(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var d=function(){return o.e("components/todoHeader").then(o.bind(null,"4f2f"))},h=function(){return o.e("components/uni-swipe-action/uni-swipe-action").then(o.bind(null,"783a"))},f=function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-swipe-action-item/uni-swipe-action-item")]).then(o.bind(null,"79e1"))},l={components:{TodoHeader:d,uniSwipeAction:h,uniSwipeActionItem:f},data:function(){return{todoList:[],showTextarea:!1,actionVisible:!1,height:0,textValue:"",isAddingTodo:!1,options:[{text:"取消置顶"}]}},computed:c({},(0,n.mapState)(["tab","isLogin"]),{listData:function(){var t=JSON.parse(JSON.stringify(this.todoList));return 0===this.tab?t.filter(function(t){return!t.checked}):1===this.tab?t.filter(function(t){return t.checked}):2===this.tab?t:void 0}}),methods:c({},(0,n.mapMutations)(["switchTab","changeTodoCount","changeRestTodoCount"]),{addTodo:function(){this.isLogin?(this.showTextarea=!0,this.isAddingTodo=!0):t.showToast({title:"请先登录",image:"../../static/login.png"})},handleConfirm:function(e){if(this.showTextarea=!1,this.isAddingTodo){var o={createTime:Date.now(),content:this.textValue,checked:!1,deleted:!1};return this.todoList.push(o),t.setStorageSync("todoCount",t.getStorageSync("todoCount")+1),t.setStorageSync("restTodoCount",t.getStorageSync("restTodoCount")+1),this.changeTodoCount(1),this.changeRestTodoCount(1),this.textValue="",this.isAddingTodo=!1,void this.$http.post("/todo",o,{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(e){"Insert Success"!==e.data&&"Insert Error"===e.data&&t.showToast({title:"服务器插入失败"})})}this.$emit("hideTextarea",this.textValue),this.textValue=""},handleInput:function(t){this.textValue=t.detail.value},clickHide:function(){this.showTextarea=!1,this.textValue=""},handleDeleteTodo:function(e){var o=e.todoCreateTime,n=this.todoList.findIndex(function(t){return t.createTime===o}),r=this.todoList.splice(n,1),a=i(r,1),u=a[0].checked;console.log(u),t.setStorageSync("todoCount",t.getStorageSync("todoCount")-1),this.changeTodoCount(-1),!1===u&&(t.setStorageSync("restTodoCount",t.getStorageSync("restTodoCount")-1),this.changeRestTodoCount(-1)),this.$http.delete("/todo",{createTime:o},{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(e){"Delete Error"!==e.data?e.data:t.showToast({title:"服务器删除失败"})})},handleEditTodo:function(e){var o=this,n=e.todoCreateTime,i=e.todoContent;this.textValue=i,this.showTextarea=!0,this.$once("hideTextarea",function(e){var i=o.todoList.findIndex(function(t){return t.createTime===n}),r=c({},o.todoList[i],{content:e});o.$set(o.todoList,i,r),o.textValue="",o.$http.put("/todo",r,{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(e){"Update Error"!==e.data?e.data:t.showToast({title:"服务器更新失败"})})})},finishTodo:function(e){var o=this.todoList.findIndex(function(t){return t.createTime===e}),n=this.todoList[o].checked;n?(t.setStorageSync("restTodoCount",t.getStorageSync("restTodoCount")+1),this.changeRestTodoCount(1)):(t.setStorageSync("restTodoCount",t.getStorageSync("restTodoCount")-1),this.changeRestTodoCount(-1));var i=c({},this.todoList[o],{checked:!n});this.$set(this.todoList,o,i),this.$http.put("/todo",i,{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(e){"Update Error"!==e.data?e.data:t.showToast({title:"服务器更新失败"})})}}),onLoad:function(){var e=this;this.isLogin&&this.$http.get("/todo",{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(t){t.data.forEach(function(t){return e.todoList.push(t)})}),t.$on("loginFinished",function(){e.$http.get("/todo",{header:{Cookie:"userId=".concat(t.getStorageSync("userId"))}}).then(function(t){t.data.forEach(function(t){return e.todoList.push(t)})})})}};e.default=l}).call(this,o("543d")["default"])},2241:function(t,e,o){"use strict";var n=o("4cb0"),i=o.n(n);i.a},"3e1b":function(t,e,o){"use strict";var n,i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.textValue=e.detail.value})},r=[];o.d(e,"b",function(){return i}),o.d(e,"c",function(){return r}),o.d(e,"a",function(){return n})},"4cb0":function(t,e,o){},"9e4e":function(t,e,o){"use strict";o.r(e);var n=o("3e1b"),i=o("f001");for(var r in i)"default"!==r&&function(t){o.d(e,t,function(){return i[t]})}(r);o("2241");var a,u=o("f0c5"),c=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"e184da62",null,!1,n["a"],a);e["default"]=c.exports},f001:function(t,e,o){"use strict";o.r(e);var n=o("009e"),i=o.n(n);for(var r in n)"default"!==r&&function(t){o.d(e,t,function(){return n[t]})}(r);e["default"]=i.a},fca8:function(t,e,o){"use strict";(function(t){o("bd55"),o("921b");n(o("66fd"));var e=n(o("9e4e"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])}},[["fca8","common/runtime","common/vendor"]]]);